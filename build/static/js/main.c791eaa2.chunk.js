(this["webpackJsonpreact-three-fiber-particles-ii"]=this["webpackJsonpreact-three-fiber-particles-ii"]||[]).push([[0],{29:function(e,t,r){e.exports=r(37)},36:function(e,t,r){},37:function(e,t,r){"use strict";r.r(t);var a=r(4),n=r(1),o=r(10),i=r.n(o),s=r(0),c=r.n(s),u=r(5),l=r(12),m=r.n(l),h=r(19),f=r(25),d=r(11),v=r(20),p=r(26),g=r(27),y=r(3),b={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:"varying vec2 vUv;\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }",fragmentShader:"uniform int byp; //should we apply the glitch\n    uniform sampler2D tDiffuse;\n    uniform sampler2D tDisp;\n    uniform float amount;\n    uniform float angle;\n    uniform float seed;\n    uniform float seed_x;\n    uniform float seed_y;\n    uniform float distortion_x;\n    uniform float distortion_y;\n    uniform float col_s;\n    varying vec2 vUv;\n    float rand(vec2 co){\n      return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n    }\n    void main() {\n      if(byp<1) {\n        vec2 p = vUv;\n        float xs = floor(gl_FragCoord.x / 0.5);\n        float ys = floor(gl_FragCoord.y / 0.5);\n        //based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n        vec4 normal = texture2D (tDisp, p*seed*seed);\n        if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n          if(seed_x>0.){\n            p.y = 1. - (p.y + distortion_y);\n          }\n          else {\n            p.y = distortion_y;\n          }\n        }\n        p.x+=normal.x*seed_x*(seed/5.);\n        p.y+=normal.y*seed_y*(seed/5.);\n        //base from RGB shift shader\n        vec2 offset = amount * vec2( cos(angle), sin(angle));\n        vec4 cr = texture2D(tDiffuse, p + offset);\n        vec4 cga = texture2D(tDiffuse, p);\n        vec4 cb = texture2D(tDiffuse, p - offset);\n        gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n      }\n      else {\n        gl_FragColor=texture2D (tDiffuse, vUv);\n      }\n    }"},x=function(e){y.a.call(this),void 0===b&&console.error("THREE.GlitchPass relies on THREE.DigitalGlitch");var t=b;this.uniforms=n.UniformsUtils.clone(t.uniforms),void 0===e&&(e=64),this.uniforms.tDisp.value=this.generateHeightmap(e),this.material=new n.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.camera=new n.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new n.Scene,this.quad=new n.Mesh(new n.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.factor=0};x.prototype=Object.assign(Object.create(y.a.prototype),{constructor:x,render:function(e,t,r,a,o){var i=Math.max(0,this.factor);this.uniforms.tDiffuse.value=r.texture,this.uniforms.seed.value=Math.random()*i,this.uniforms.byp.value=0,i?(this.uniforms.amount.value=Math.random()/90*i,this.uniforms.angle.value=n.Math.randFloat(-Math.PI,Math.PI)*i,this.uniforms.distortion_x.value=n.Math.randFloat(0,1)*i,this.uniforms.distortion_y.value=n.Math.randFloat(0,1)*i,this.uniforms.seed_x.value=n.Math.randFloat(-.3,.3)*i,this.uniforms.seed_y.value=n.Math.randFloat(-.3,.3)*i):this.uniforms.byp.value=1,this.quad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera))},generateHeightmap:function(e){for(var t=new Float32Array(e*e*3),r=e*e,a=0;a<r;a++){var o=n.Math.randFloat(0,1);t[3*a+0]=o,t[3*a+1]=o,t[3*a+2]=o}var i=new n.DataTexture(t,e,e,n.RGBFormat,n.FloatType);return i.needsUpdate=!0,i}});var M={uniforms:{byp:{value:0},texture:{type:"t",value:null},time:{type:"f",value:0},factor:{type:"f",value:0},resolution:{type:"v2",value:null}},vertexShader:"varying vec2 vUv;\n    void main(){  \n      vUv = uv; \n      vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);\n      gl_Position = projectionMatrix * modelViewPosition;\n    }",fragmentShader:"uniform int byp; //should we apply the glitch ?\n    uniform float time;\n    uniform float factor;\n    uniform vec2 resolution;\n    uniform sampler2D texture;\n    \n    varying vec2 vUv;\n    \n    void main() {  \n      if (byp<1) {\n        vec2 uv1 = vUv;\n        vec2 uv = gl_FragCoord.xy/resolution.xy;\n        float frequency = 6.0;\n        float amplitude = 0.015 * factor;\n        float x = uv1.y * frequency + time * .7; \n        float y = uv1.x * frequency + time * .3;\n        uv1.x += cos(x+y) * amplitude * cos(y);\n        uv1.y += sin(x-y) * amplitude * cos(y);\n        vec4 rgba = texture2D(texture, uv1);\n        gl_FragColor = rgba;\n      } else {\n        gl_FragColor = texture2D(texture, vUv);\n      }\n    }"},w=function(e){y.a.call(this),void 0===M&&console.error("THREE.WaterPass relies on THREE.WaterShader");var t=M;this.uniforms=n.UniformsUtils.clone(t.uniforms),void 0===e&&(e=64),this.uniforms.resolution.value=new n.Vector2(e,e),this.material=new n.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.camera=new n.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new n.Scene,this.quad=new n.Mesh(new n.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.factor=0,this.time=0};w.prototype=Object.assign(Object.create(y.a.prototype),{constructor:w,render:function(e,t,r,a,n){var o=Math.max(0,this.factor);this.uniforms.byp.value=o?0:1,this.uniforms.texture.value=r.texture,this.uniforms.time.value=this.time,this.uniforms.factor.value=this.factor,this.time+=.05,this.quad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera))}});var E=r(28),O=Object(s.forwardRef)((function(e,t){var r=e.children,a=e.vAlign,o=void 0===a?"center":a,i=e.hAlign,l=void 0===i?"center":i,m=e.size,h=void 0===m?1:m,f=(e.color,Object(E.a)(e,["children","vAlign","hAlign","size","color"])),d=Object(u.d)(n.FontLoader,"/bold.blob"),v=Object(s.useMemo)((function(){return{font:d,size:40,height:50}}),[d]),p=Object(u.f)((function(e){var t=new n.Vector3;e.geometry.computeBoundingBox(),e.geometry.boundingBox.getSize(t),e.position.x="center"===l?-t.x/2:"right"===l?0:-t.x,e.position.y="center"===o?-t.y/2:"top"===o?0:-t.y}),[r]);return c.a.createElement("group",Object.assign({ref:t},f,{scale:[.1*h,.1*h,.1]}),c.a.createElement("mesh",{ref:p},c.a.createElement("textGeometry",{attach:"geometry",args:[r,v]}),c.a.createElement("meshNormalMaterial",{attach:"material"})))}));r(36);function j(e){var t=e.curve,r=e.width,a=e.color,n=e.speed,o=Object(s.useRef)();return Object(u.c)((function(){return o.current.uniforms.dashOffset.value-=n})),c.a.createElement("mesh",null,c.a.createElement("meshLine",{attach:"geometry",vertices:t}),c.a.createElement("meshLineMaterial",{attach:"material",ref:o,transparent:!0,depthTest:!1,lineWidth:r,color:a,dashArray:.1,dashRatio:.95}))}function _(){return Math.max(.5,Math.random())}function P(e){var t=e.mouse,r=e.count,a=e.colors,o=e.radius,i=void 0===o?15:o,l=Object(s.useMemo)((function(){return new Array(r).fill().map((function(){var e=new n.Vector3(Math.sin(0)*i*_(),Math.cos(0)*i*_(),0),t=new Array(30).fill().map((function(t,r){var a=r/20*Math.PI*2;return e.add(new n.Vector3(Math.sin(a)*i*_(),Math.cos(a)*i*_(),0)).clone()})),r=new n.CatmullRomCurve3(t).getPoints(1e3);return{color:a[parseInt(a.length*Math.random())],width:.1,speed:Math.max(5e-4,.001*Math.random()),curve:r}}))}),[r]),h=Object(s.useRef)(),f=Object(u.e)(),d=f.size,v=f.viewport,p=d.width/v.width;return Object(u.c)((function(e){h.current&&(h.current.rotation.x=m()(h.current.rotation.x,0+t.current[1]/p/50,.1),h.current.rotation.y=m()(h.current.rotation.y,0+t.current[0]/p/100,.1))})),c.a.createElement("group",{ref:h},c.a.createElement("group",{position:[2*-i,-i,0]},l.map((function(e,t){return c.a.createElement(j,Object.assign({key:t},e))}))))}function F(e){var t=e.count,r=e.mouse,a=Object(s.useRef)(),o=Object(s.useRef)(),i=Object(u.e)(),l=i.size,m=i.viewport,h=l.width/m.width,f=Object(s.useMemo)((function(){return new n.Object3D}),[]),d=Object(s.useMemo)((function(){for(var e=[],r=0;r<t;r++){var a=100*Math.random(),n=20+100*Math.random(),o=.01+Math.random()/200,i=100*Math.random()-50,s=100*Math.random()-50,c=100*Math.random()-50;e.push({t:a,factor:n,speed:o,xFactor:i,yFactor:s,zFactor:c,mx:0,my:0})}return e}),[t]);return Object(u.c)((function(e){o.current.position.set(r.current[0]/h,-r.current[1]/h,0),d.forEach((function(e,t){var n=e.t,o=e.factor,i=e.speed,s=e.xFactor,c=e.yFactor,u=e.zFactor;n=e.t+=i/2;var l=Math.cos(n)+Math.sin(1*n)/10,m=Math.sin(n)+Math.cos(2*n)/10,h=Math.cos(n);e.mx+=.01*(r.current[0]-e.mx),e.my+=.01*(-1*r.current[1]-e.my),f.position.set(e.mx/10*l+s+Math.cos(n/10*o)+Math.sin(1*n)*o/10,e.my/10*m+c+Math.sin(n/10*o)+Math.cos(2*n)*o/10,e.my/10*m+u+Math.cos(n/10*o)+Math.sin(3*n)*o/10),f.scale.set(h,h,h),f.rotation.set(5*h,5*h,5*h),f.updateMatrix(),a.current.setMatrixAt(t,f.matrix)})),a.current.instanceMatrix.needsUpdate=!0})),c.a.createElement(c.a.Fragment,null,c.a.createElement("pointLight",{ref:o,distance:40,intensity:8,color:"lightblue"}),c.a.createElement("instancedMesh",{ref:a,args:[null,null,t]},c.a.createElement("dodecahedronBufferGeometry",{attach:"geometry",args:[.2,0]}),c.a.createElement("meshPhongMaterial",{attach:"material",color:"#050505"})))}function C(e){var t=e.down,r=Object(s.useRef)(),a=Object(u.e)(),o=a.scene,i=a.gl,l=a.size,m=a.camera,h=Object(s.useMemo)((function(){return new n.Vector2(l.width,l.height)}),[l]);return Object(s.useEffect)((function(){r.current.setSize(l.width,l.height)}),[l]),Object(u.c)((function(){return r.current.render()}),1),c.a.createElement("effectComposer",{ref:r,args:[i]},c.a.createElement("renderPass",{attachArray:"passes",scene:o,camera:m}),c.a.createElement("waterPass",{attachArray:"passes",factor:1.5}),c.a.createElement("unrealBloomPass",{attachArray:"passes",args:[h,2,1,0]}),c.a.createElement("glitchPass",{attachArray:"passes",factor:t?1:0}))}function D(e){var t=Object(s.useMemo)((function(){var e=new n.EllipseCurve(0,0,10,3,0,2*Math.PI,!1,0).getPoints(50);return(new n.BufferGeometry).setFromPoints(e)}),[]);return c.a.createElement("line",Object.assign({geometry:t},e),c.a.createElement("meshBasicMaterial",{attach:"material"}))}function S(e){var t=e.mouse,r=e.hover,a=Object(s.useRef)(),n=Object(u.e)(),o=n.size,i=n.viewport,l=o.width/i.width;return Object(u.c)((function(e){a.current&&(a.current.position.x=m()(a.current.position.x,t.current[0]/l/10,.1),a.current.rotation.x=m()(a.current.rotation.x,0+t.current[1]/l/50,.1),a.current.rotation.y=.8)})),c.a.createElement(s.Suspense,{fallback:null},c.a.createElement("group",{ref:a},c.a.createElement(O,{size:10,onClick:function(e){return window.open("https://github.com/react-spring/react-three-fiber/blob/master/whatsnew.md","_blank")},onPointerOver:function(){return r(!0)},onPointerOut:function(){return r(!1)}},"4"),c.a.createElement("group",{position:[35,-20,0],scale:[1,.5,1]},c.a.createElement(D,null),c.a.createElement(D,{rotation:[0,0,Math.PI/3]}),c.a.createElement(D,{rotation:[0,0,-Math.PI/3]}),c.a.createElement("mesh",null,c.a.createElement("sphereBufferGeometry",{attach:"geometry",args:[.5,32,32]}),c.a.createElement("meshBasicMaterial",{attach:"material",color:"red"})))))}Object(u.b)({EffectComposer:f.a,ShaderPass:d.a,RenderPass:v.a,WaterPass:w,UnrealBloomPass:p.a,FilmPass:g.a,GlitchPass:x}),Object(u.b)(h),i.a.render(c.a.createElement((function(){var e=Object(s.useState)(!1),t=Object(a.a)(e,2),r=t[0],o=t[1],i=Object(s.useState)(!1),l=Object(a.a)(i,2),m=l[0],h=l[1],f=Object(s.useRef)([0,0]),d=Object(s.useCallback)((function(e){var t=e.clientX,r=e.clientY;return f.current=[t-window.innerWidth/2,r-window.innerHeight/2]}),[]),v=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return Object(s.useEffect)((function(){document.body.style.cursor=r?"pointer":"url('https://raw.githubusercontent.com/chenglou/react-motion/master/demos/demo8-draggable-list/cursor.png') 39 39, auto"}),[r]),c.a.createElement(c.a.Fragment,null,c.a.createElement(u.a,{pixelRatio:Math.min(2,v?window.devicePixelRatio:1),camera:{fov:100,position:[0,0,30]},onMouseMove:d,onMouseUp:function(){return h(!1)},onMouseDown:function(){return h(!0)},onCreated:function(e){var t=e.gl;t.toneMapping=n.Uncharted2ToneMapping,t.setClearColor(new n.Color("#020207"))}},c.a.createElement("fog",{attach:"fog",args:["white",50,190]}),c.a.createElement("pointLight",{distance:100,intensity:4,color:"white"}),c.a.createElement(S,{mouse:f,hover:o}),c.a.createElement(F,{count:v?5e3:1e4,mouse:f}),c.a.createElement(P,{count:10,mouse:f,colors:["#A2CCB6","#FCEEB5","#EE786E","#e0feff","lightpink","lightblue"]}),c.a.createElement(C,{down:m})),c.a.createElement("div",{className:"frame"},c.a.createElement("a",{className:"frame__title",href:"https://github.com/react-spring/react-three-fiber"},"react/three/fiber")))}),null),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.c791eaa2.chunk.js.map